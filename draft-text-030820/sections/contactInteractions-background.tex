\section{Background Modeling}\label{sec:ciBkg}

A expectation of the number of events under the background-only hypothesis is needed for each of the four signal regions.
This raises the question of what exactly is meant by \emph{background}.
The observed data, in the full mass range, are considered have been produced according to some PDF.
If the PDF does not contain a contribution from a signal-like production mechanism, then this is what is meant by the background-PDF.
This is emphatically not the same thing as the physical truth-PDF that has generated the collected data.
The background-only hypothesis predicts that the event yield in each signal region equal the yield predicted by the background-PDF, normalized to the collected integrated luminosity.
Of course this background-PDF is not explicitly known, and therefore a methodology for estimating it's predicted yield is needed.
This section describes how this is done using an estimate in the CR.

This search uses a functional form fit to the shape of the data in a low mass control region and extrapolated into the high mass signal region, where it is integrated.
In principle, any functional form is acceptable, as long as the uncertainties on the background estimate in the SR are properly measured.
In practice, to produce competitive results, it is necessary to select a functional form that well models the underlying distribution that has generated the background component of the data.

The functional form was chosen from a large list of candidates for its stability during extrapolations, ability to model the MC background. Here, stability refers to the function to not have the tendency to behave nonphysically.
The procedure to determine the functional form of the background is as follows.
The smooth functional form used to model the background is chosen from about 50 candidate functions.
Each function is fit to the dilepton mass background template, consisting of the sum of all the simulated background contributions, in a variety of CRs and extrapolated to the respective SRs.
The data and simulation are both fit using a binned-likelihood maximisation with a bin width of 1~GeV.
The distribution of the pulls, defined as (fit--simulation)/fit for each bin, is obtained for each potential configuration of CR and SR.
A function that results in pulls below 3 across all the ranges considered (CRs and SRs) is marked as acceptable.
This requirement is particularly important in the SRs to veto functions that exhibit unphysical behaviour at the tail.
Additionally, it is important to ensure a good description of the simulated background template in the CRs.
Out of about 50 initial functions, five are found to satisfy this requirement equally well.
The residual mis-modeling by the selected function is measured later and taken as an uncertainty.
The functions that were found to best satisfy these criteria are given in equations \ref{eqn:ciBkgEe} and \ref{eq:ciBkgMm} for $ee$ and $\mu\mu$ channels respectively.
\begin{equation}\begin{split} \label{eqn:ciBkgEe}
f_\textrm{b}(\mee) &= f_{\mathrm{BW},Z}(\mee) \cdot \left(1 - x\right)^{b} \cdot x^{\sum_{i=0}^3 p_i\log(x)^i} \\
\end{split}\end{equation} 
\begin{equation}\begin{split}\label{eqn:ciBkgMm}
f_\textrm{b}(\mee) &= f_{\mathrm{BW},Z}(\mee) \cdot \left(1 - x^{1/3}\right)^{b} \cdot x^{\sum_{i=0}^3 p_i\log(x)^i} \\
\end{split}\end{equation} 
where $x = m_{\ell\ell}/\sqrt{s}$.
The first term, $f_{\mathrm{BW},Z}(m_{\ell\ell})$, is a non-relativistic Breit--Wigner function with $m_Z = 91.1876$~GeV and $\Gamma_Z = 2.4952$~GeV.
This primarily dictates the function shape in the low-mass regime of the control region.
The second term, $(1-x^{c})^{b}$, shapes the high-mass behavior of the function by ensuring that the background shape evaluates to zero at $x\to 1$.
The parameter $b$ is fixed to values obtained from fits to the simulated background.
In the third term, the parameters $p_i$ with $i=0,..,3$ are left free in the fits.
The function $f_\textrm{b}(m_{\ell\ell})$ is treated as a probability density function in the fits performed in the CR.
This function is then normalised in the CR to $N_\textrm{CR}$, the number of events in the CR in data (or simulation where applicable), where it is assumed that the CR is completely dominated by background events.

The fits are performed using a binned likelihood maximization using the MINUIT algorithm \cite{minuit}.
The functional forms of Equations \ref{eqn:ciBkgEe} and \ref{eqn:ciBkgMm} are fit to a \emph{template}, which may is a histogram filled by either data or simulated data.
In this process, the total log-likelihood of the template is calculated as the sum of the log-likelihood of each template bin to have been generated by the functional form.
Then, each of the flexible parameters of the functional forms is adjusted with MINUIT until the total log-likelihood has reached a maximum.
The functional form with these parameter fitted values is the function with the highest likelihood to generate the observed data.

% Definitions of function vs ''background model''
It is worth explicating some nomenclature. 
The normalized and fitted functions of Equations \ref{eqn:ciBkgEe} and \ref{eqn:ciBkgMm} describe well the differential shape of the data in each CR.
To a lessor extent, these forms also describe the differential shape of the data in each SR.
The background estimate that is used for the purpose of this analysis, however, is the integral of these functions in the SR.

This number is interpreted as the mean number of events to expect in the SR under the background-only hypothesis.
Of course this differs from the true prediction of that hypothesis on three counts.
First, the assumption of particular forms of Equations \ref{eqn:ciBkgEe} and \ref{eqn:ciBkgMm} implicitly assumes these match the shape of the background-PDF.
Second, the fits are performed to the finite data in the CR, not to the underlying PDF.
This means that statistical fluctuations in the CR influence the shape of the fitted function, and therefore background estimate.
Third, the fit performed in the CR is data generated by the truth-PDF, not the background-PDF. 
This implicitly assumes that no signal process contributes to the events in the CR. 
These three assumptions mean that the background estimate described here is in fact an approximation of the true underlying background yield in each SR.
The accuracy of this approximation is described by systematic uncertainties on the background estimate.
